(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();function J(){const e=window.location.pathname,t=document.querySelector(".header__link.nonograms"),o=document.querySelector(".header__link.gallery");(e.endsWith("/nonograms/")?t:o).classList.add("accent")}const R=document.querySelector(".switch-theme__input");function $(e){const t=document.cookie.split(";").map(o=>o.trim());for(const o of t){const[r,n]=o.split("=");if(r===e)return n}return null}function K(e){const t=document.querySelector(".switch-theme__input");t.checked=e==="dark",document.documentElement.className=e}function N(e,t,o){let r=new Date;r.setTime(r.getTime()+o*24*60*60*1e3);let n=`expires=${r.toUTCString()}`;document.cookie=`${e}=${t};${n};path=/`}function B(e){e.currentTarget.checked?(document.documentElement.classList.replace("light","dark"),N("displayMode","dark",30)):(document.documentElement.classList.replace("dark","light"),N("displayMode","light",30))}class V{constructor(t){this.playlist=t,this.currentTrackIndex=0,this.isPlaying=!1,this.audioPlayer=new Audio,this.audioPlayer.src=this.playlist[this.currentTrackIndex],this.audioPlayer.addEventListener("ended",()=>this.playNextTrack())}playNextTrack(){this.currentTrackIndex=(this.currentTrackIndex+1)%this.playlist.length,this.audioPlayer.src=this.playlist[this.currentTrackIndex],this.audioPlayer.play()}play(){this.audioPlayer.play(),this.isPlaying=!0}pause(){this.audioPlayer.pause(),this.isPlaying=!1}togglePlayPause(){this.isPlaying?this.pause():this.play()}}const P="/Palmo-Edu/nonograms/music/",j=[`${P}alexander-nakarada-emotional-piano-improvisation.mp3`,`${P}alexander-nakarada-winter.mp3`],z=new V(j);function F(e){z.togglePlayPause(),e.currentTarget.classList.toggle("off")}const U=document.querySelector(".header__btn.turn-music"),D=document.querySelector(".modal__container"),u=document.querySelector(".modal");function x(e){e&&u.classList.add(e),D.classList.add("active"),u.classList.add("active")}function f(e){u.append(e)}function h(){for(D.classList.remove("active"),u.classList.remove("active");u.firstElementChild.nextElementSibling;)u.firstElementChild.nextElementSibling.remove()}const C=u==null?void 0:u.querySelector(".close"),W=[[0,0,0,1,1],[0,0,0,1,0],[0,0,0,1,0],[1,1,1,1,0],[0,1,0,1,0]],Z=[[1,0,1,0,1],[1,1,1,1,1],[0,1,1,1,0],[0,1,0,1,0],[0,1,1,1,0]],Q=[[0,0,1,0,0],[0,1,1,1,0],[1,1,1,1,1],[0,0,1,0,0],[0,1,1,1,0]],X=[[0,1,1,1,0],[0,1,1,1,0],[0,1,1,1,0],[0,0,1,0,0],[0,1,1,1,0]],Y=[[0,1,1,1,0],[1,1,1,1,1],[1,0,1,0,1],[1,1,1,1,1],[0,1,0,1,0]],ee=[[0,0,1,1,1,1,1,1,0,0],[0,1,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,1],[1,0,1,1,0,0,1,1,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,1,0,0,0,1],[1,0,1,0,0,0,0,1,0,1],[1,0,0,1,1,1,1,0,0,1],[0,1,0,0,0,0,0,0,1,0],[0,0,1,1,1,1,1,1,0,0]],te=[[0,0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0],[0,0,0,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0]],ne=[[0,0,1,0,1,0,1,0,0,0],[0,0,1,0,1,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,0,0],[0,1,1,0,1,1,1,1,1,1],[0,1,1,0,1,1,1,1,0,1],[0,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0,0],[0,1,1,1,1,1,1,1,1,0]],oe=[[0,0,0,0,1,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,0,0,0],[0,1,1,1,1,1,1,1,0,0],[1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0],[0,1,0,0,1,0,0,1,0,0],[0,1,0,0,1,0,0,1,0,0],[0,1,1,1,1,0,0,1,0,0],[0,1,1,1,1,0,0,1,0,0]],re=[[0,0,1,1,0,0,0,1,1,0],[0,1,0,0,1,0,1,0,0,1],[0,1,0,1,1,1,1,1,0,1],[0,0,1,1,0,1,0,1,1,0],[0,0,0,1,1,1,1,1,0,0],[0,0,1,1,1,0,1,1,1,0],[0,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0]],se=[[1,1,0,1,1,0,0,0,0,0,0,1,1,0,1],[1,1,0,1,1,0,1,0,0,1,0,1,1,0,1],[0,1,1,1,1,0,1,0,0,1,0,1,1,0,1],[0,0,1,1,1,1,1,0,0,0,1,1,1,1,1],[0,0,0,0,1,1,0,1,1,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,0,0],[0,0,0,0,0,1,0,1,0,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,0,1,1,1,1,1],[0,1,0,1,1,1,0,0,0,0,1,1,1,1,1],[0,1,1,1,1,1,0,0,0,0,1,1,1,1,1],[0,0,1,1,1,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1]],ie=[[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,1,0,1,1,0,1,0,0,0,1,1,0,1,1],[1,1,1,1,1,0,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,0,1,0,0,0,1,0,0,0,1],[1,0,1,0,1,0,1,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,1,0,0,0,0,0,0,0,1,0,0,1],[1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],[1,0,0,1,0,0,1,1,1,0,0,1,0,0,1],[1,0,0,1,0,0,1,1,1,0,0,1,0,0,1],[1,0,0,0,0,0,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],ae=[[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,1,0,1,0,1,0,1,0,1,0,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,1,0,1,1,1,1,1,1,1,0,1,1,0],[0,1,0,0,0,1,1,0,1,1,0,0,0,1,0],[0,1,1,0,1,1,0,0,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,0,0,1,1,0,1,1,0],[0,1,1,1,1,1,0,0,0,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0]],ce=[[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,1,1,1,1,0,1,1,1],[0,0,0,0,0,0,0,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,0,0],[1,0,0,0,0,0,1,1,1,1,1,1,1,1,0],[1,1,1,0,0,1,1,1,0,0,0,1,1,1,0],[1,1,1,1,1,1,1,0,1,1,1,0,1,1,0],[0,1,1,1,1,1,0,1,1,1,1,0,1,1,0],[0,1,1,1,1,1,1,1,1,0,0,1,1,0,0],[0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,0,0,1,1,0,1,1,1,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,0,0,0]],le=[[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,0,0,0,0,1,1,1,1,0,0,1,1,0,1],[0,0,0,1,1,1,0,0,1,0,0,1,0,1,0],[1,1,1,0,1,1,1,0,1,0,0,1,0,0,0],[1,1,1,1,1,1,1,1,0,0,0,1,1,0,0],[0,1,1,1,1,1,1,1,1,0,0,0,1,1,0],[0,0,0,0,1,1,1,1,1,1,0,0,0,1,1],[0,0,0,0,0,1,1,1,1,1,1,1,0,0,1],[0,0,0,0,0,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,0,0,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,1,1,1,1,0,0,1,1,1,0],[0,0,0,0,1,1,1,0,0,0,1,1,1,0,0]],O={easy:[{name:"Dinosaur",matrix:W},{name:"Fortress",matrix:Z},{name:"Plane",matrix:Q},{name:"Goblet",matrix:X},{name:"Skull",matrix:Y}],medium:[{name:"House",matrix:oe},{name:"Aerostat",matrix:te},{name:"Cuppa",matrix:ne},{name:"Smiley",matrix:ee},{name:"Mouse",matrix:re}],hard:[{name:"Deer",matrix:se},{name:"Rat",matrix:le},{name:"Castle",matrix:ie},{name:"Duck",matrix:ce},{name:"Church",matrix:ae}]};function de(e,t){e.innerHTML="",O[t].map(n=>n.name).forEach(n=>{const s=document.createElement("option");s.value=n,s.textContent=n,s.className="nonogram-names-option",e.appendChild(s)})}const m=JSON.parse(localStorage.getItem("currentNonogram"))||null,a={nonogram:{name:"",playerName:"uknown player",difficulty:"",matrix:[],currentProgress:(m==null?void 0:m.currentProgress)||[],truthyCellsIndexes:(m==null?void 0:m.truthyCellsIndexes)||[],excludedCellsIndexes:(m==null?void 0:m.excludedCellsIndexes)||[],truthyCells:[],falsyCells:[]}},w=a.nonogram;function L(e){for(const t in e)e.hasOwnProperty(t)&&w.hasOwnProperty(t)&&(w[t]=e[t])}function q(e=0){return Array.from({length:e},()=>Array(e).fill(0))}function me(e){const t=[];for(let o=0;o<e[0].length;o++){const r=[];for(let n=e.length-1;n>=0;n--)r.push(e[n][o]);t.push(r.reverse())}return t}function M(e){let t=[],o=1;if(!e.includes(1))return t.push(0),t.join(" ");for(let r=0;r<e.length;r+=1){let n=e[r],s=e[r+1];n===1&&s===1?o+=1:n===1&&!s&&(t.push(o),o=1)}return t.join(" ")}function ue(){const t=document.getElementById("helpDialog").content.cloneNode(!0);return t.querySelector(".ok").addEventListener("click",h),t}function ge(){const e=a.nonogram.matrix,t=me(e),o=document.createElement("thead"),r=document.createElement("tr");for(let n=0;n<=e.length;n++){const s=document.createElement("th");if(s.className=`th_top ${a.nonogram.difficulty}`,n===0){const i=document.createElement("button");i.textContent="?",i.title="HELP",i.addEventListener("click",()=>{const d=ue();f(d),x("confirm")}),s.appendChild(i)}if(n>0&&t[n-1]){const i=M(t[n-1]);s.innerHTML=i.replace(/\s/g,"<br>")}r.appendChild(s)}return o.appendChild(r),o}function _(){const e={name:"",playerName:"",difficulty:"",matrix:[],currentProgress:[],truthyCells:[],falsyCells:[],truthyCellsIndexes:[],excludedCellsIndexes:[]};L(e),localStorage.setItem("currentNonogram",JSON.stringify(e))}function G(){const{truthyCells:e,falsyCells:t}=a.nonogram;e.forEach(o=>{o.classList.remove("excluded","border5x5H","border5x5V"),o.classList.add("colorized")}),t.forEach(o=>{o.classList.remove("colorized","excluded","border5x5H","border5x5V")}),y.style.pointerEvents="none",_()}function he(){const t=document.getElementById("victoryDialog").content.cloneNode(!0);return t.querySelector(".ok").addEventListener("click",h),t}function fe(){JSON.parse(JSON.stringify(a.nonogram));const e=he();f(e),x("victory"),G()}function ye(e,t){if(e.target.nodeName!=="TD")return;const o=a.nonogram.currentProgress,r=a.nonogram.matrix,n=e.target;n.classList.toggle("colorized"),n.classList.remove("excluded");const s=t.indexOf(n),i=Math.floor(s/r.length),d=s-r.length*i,l=o[i];let c=l[d];c=c?0:1,l[d]=c;const g=a.nonogram.truthyCellsIndexes,p=a.nonogram.excludedCellsIndexes;if(c)g.push(s);else{const b=g.indexOf(s);b!==-1&&g.splice(b,1)}const k=p.indexOf(s);k!==-1&&p.splice(k,1);const S=JSON.parse(localStorage.getItem("currentNonogram"))||{};S.currentProgress=o,S.truthyCellsIndexes=g,S.excludedCellsIndexes=p,localStorage.setItem("currentNonogram",JSON.stringify(S)),JSON.stringify(o)===JSON.stringify(r)&&fe()}class pe{constructor(t){this.container=t,this.time=Number(localStorage.getItem("timer"))||0,this.intervalId=null,this.isRunning=!1,this.render()}start(){this.intervalId||(this.intervalId=setInterval(()=>{this.time+=1,this.update()},1e3),this.isRunning=!0)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,this.isRunning=!1)}reset(){this.stop(),this.time=0,this.update()}render(){this.container instanceof Element&&(this.container.textContent=this.formatTime(this.time))}update(){this.container instanceof Element&&(this.container.textContent=this.formatTime(this.time),localStorage.setItem("timer",this.time))}formatTime(t){const o=Math.floor(t/60),r=t%60,n=String(o).padStart(2,"0"),s=String(r).padStart(2,"0");return`${n}:${s}`}}const xe=document.querySelector(".timer-section span"),T=new pe(xe);function A(){const e=[],t=[],o=[],r=document.createElement("tbody"),n=a.nonogram.matrix;for(let i=0;i<n.length;i++){const d=document.createElement("tr");for(let l=0;l<=n.length;l++){let c;l===0?(c=document.createElement("th"),c.classList.add("th_left",a.nonogram.difficulty),c.textContent=M(n[i])):(c=document.createElement("td"),c.classList.add("td",a.nonogram.difficulty),l%5===0&&n.length>5&&l!==n[i].length&&c.classList.add("border5x5V"),(i+1)%5===0&&n.length>5&&i+1!==n.length&&c.classList.add("border5x5H"),n[i][l-1]===1&&o.push(c),n[i][l-1]===0&&t.push(c),e.push(c)),d.appendChild(c)}r.appendChild(d)}r.addEventListener("click",i=>ye(i,e));function s(i){!T.isRunning&&i.target.nodeName==="TD"&&T.start()}return r.addEventListener("click",s,{once:!0}),r.addEventListener("contextmenu",i=>{i.preventDefault(),s(i)},{once:!0}),a.nonogram.truthyCells=o,a.nonogram.falsyCells=t,r}const y=document.getElementById("table");function Se(){y.innerHTML="";const e=ge(),t=A();y.append(e,t)}function Ce(){const t=document.getElementById("newGameDialog").content.cloneNode(!0),o=t.querySelector("form.start-game-form"),r=o.querySelector("#difficulty-select"),n=o.querySelector("#nonogram-names-select"),s=o.querySelector("#playerName");return r.addEventListener("change",()=>{const i=r.value;de(n,i)}),o.addEventListener("submit",i=>{i.preventDefault();const d=n.value,l=r.value,c=O[l].find(({name:p})=>p===d).matrix,g={name:d,difficulty:l,playerName:s.value.trim()||"uknown player",matrix:c,currentProgress:q(c.length)};_(),L(g),console.log(a),localStorage.setItem("currentNonogram",JSON.stringify(g)),h(),y.style.pointerEvents="all",Se()}),t}function Ee(){const e=y.querySelector("tbody"),t=y.querySelector("thead");e.remove();const o=a.nonogram.matrix.length,r={currentProgress:q(o),excludedCellsIndexes:[],truthyCellsIndexes:[]};L(r);const n=JSON.parse(localStorage.getItem("currentNonogram"))||{};n.currentProgress=a.nonogram.currentProgress,n.excludedCellsIndexes=a.nonogram.excludedCellsIndexes,n.truthyCellsIndexes=a.nonogram.truthyCellsIndexes,localStorage.setItem("currentNonogram",JSON.stringify(n)),t.insertAdjacentElement("afterend",A())}function H(){const t=document.getElementById("resetGameDialog").content.cloneNode(!0);return t.querySelector(".ok").addEventListener("click",h),t}function ve(){var t,o;if(!!((t=a==null?void 0:a.nonogram)!=null&&t.name)&&!!((o=a==null?void 0:a.nonogram)!=null&&o.difficulty))Ee();else{const r=H();f(r),x("alert")}}function Ie(){const t=document.getElementById("showSolutionDialog").content.cloneNode(!0),o=t.querySelector(".submit"),r=t.querySelector(".cancel");return o.addEventListener("click",()=>{G(),h()}),r.addEventListener("click",h),t}function Le(){var t,o;if(!!((t=a==null?void 0:a.nonogram)!=null&&t.name)&&!!((o=a==null?void 0:a.nonogram)!=null&&o.difficulty)){const r=Ie();f(r)}else{const r=H();f(r)}x("alert")}const E=document.querySelector(".control-btn.new-game"),v=document.querySelector(".control-btn.reset-game"),I=document.querySelector(".control-btn.show-solution");function ke(){E==null||E.addEventListener("click",()=>{const e=Ce();f(e),x("confirm")}),v==null||v.addEventListener("click",ve),I==null||I.addEventListener("click",Le)}document.addEventListener("DOMContentLoaded",function(){const e=$("displayMode")||"light";K(e)});R.addEventListener("click",B);U.addEventListener("click",F);J();ke();C==null||C.addEventListener("click",h);
//# sourceMappingURL=main-DFha6Rbd.js.map
