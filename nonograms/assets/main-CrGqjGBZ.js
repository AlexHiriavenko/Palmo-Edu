(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();function $(){const t=window.location.pathname,e=document.querySelector(".header__link.nonograms"),o=document.querySelector(".header__link.gallery");(t.endsWith("/nonograms/")?e:o).classList.add("accent")}const j=document.querySelector(".switch-theme__input");function K(t){const e=document.cookie.split(";").map(o=>o.trim());for(const o of e){const[r,n]=o.split("=");if(r===t)return n}return null}function V(t){const e=document.querySelector(".switch-theme__input");e.checked=t==="dark",document.documentElement.className=t}function T(t,e,o){let r=new Date;r.setTime(r.getTime()+o*24*60*60*1e3);let n=`expires=${r.toUTCString()}`;document.cookie=`${t}=${e};${n};path=/`}function B(t){t.currentTarget.checked?(document.documentElement.classList.replace("light","dark"),T("displayMode","dark",30)):(document.documentElement.classList.replace("dark","light"),T("displayMode","light",30))}class z{constructor(e){this.playlist=e,this.currentTrackIndex=0,this.isPlaying=!1,this.audioPlayer=new Audio,this.audioPlayer.src=this.playlist[this.currentTrackIndex],this.audioPlayer.addEventListener("ended",()=>this.playNextTrack())}playNextTrack(){this.currentTrackIndex=(this.currentTrackIndex+1)%this.playlist.length,this.audioPlayer.src=this.playlist[this.currentTrackIndex],this.audioPlayer.play()}play(){this.audioPlayer.play(),this.isPlaying=!0}pause(){this.audioPlayer.pause(),this.isPlaying=!1}togglePlayPause(){this.isPlaying?this.pause():this.play()}}const D="/Palmo-Edu/nonograms/music/",F=[`${D}alexander-nakarada-emotional-piano-improvisation.mp3`,`${D}alexander-nakarada-winter.mp3`],U=new z(F);function W(t){U.togglePlayPause(),t.currentTarget.classList.toggle("off")}const Z=document.querySelector(".header__btn.turn-music"),q=document.querySelector(".modal__container"),g=document.querySelector(".modal");function S(t){t&&g.classList.add(t),q.classList.add("active"),g.classList.add("active")}function x(t){g.append(t)}function p(){for(q.classList.remove("active"),g.className="modal";g.firstElementChild.nextElementSibling;)g.firstElementChild.nextElementSibling.remove()}const I=g==null?void 0:g.querySelector(".close"),Q=[[0,0,0,1,1],[0,0,0,1,0],[0,0,0,1,0],[1,1,1,1,0],[0,1,0,1,0]],X=[[1,0,1,0,1],[1,1,1,1,1],[0,1,1,1,0],[0,1,0,1,0],[0,1,1,1,0]],Y=[[0,0,1,0,0],[0,1,1,1,0],[1,1,1,1,1],[0,0,1,0,0],[0,1,1,1,0]],ee=[[0,1,1,1,0],[0,1,1,1,0],[0,1,1,1,0],[0,0,1,0,0],[0,1,1,1,0]],te=[[0,1,1,1,0],[1,1,1,1,1],[1,0,1,0,1],[1,1,1,1,1],[0,1,0,1,0]],ne=[[0,0,1,1,1,1,1,1,0,0],[0,1,0,0,0,0,0,0,1,0],[1,0,0,0,0,0,0,0,0,1],[1,0,1,1,0,0,1,1,0,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,1,0,0,0,1],[1,0,1,0,0,0,0,1,0,1],[1,0,0,1,1,1,1,0,0,1],[0,1,0,0,0,0,0,0,1,0],[0,0,1,1,1,1,1,1,0,0]],oe=[[0,0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0],[0,0,0,1,1,1,1,1,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,0,0]],re=[[0,0,1,0,1,0,1,0,0,0],[0,0,1,0,1,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,1,1,1,1,1,1,1,0,0],[0,1,1,0,1,1,1,1,1,1],[0,1,1,0,1,1,1,1,0,1],[0,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0,0],[0,1,1,1,1,1,1,1,1,0]],se=[[0,0,0,0,1,0,0,0,0,0],[0,0,0,1,1,1,0,0,0,0],[0,0,1,1,1,1,1,0,0,0],[0,1,1,1,1,1,1,1,0,0],[1,1,1,1,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,0,0],[0,1,0,0,1,0,0,1,0,0],[0,1,0,0,1,0,0,1,0,0],[0,1,1,1,1,0,0,1,0,0],[0,1,1,1,1,0,0,1,0,0]],ce=[[0,0,1,1,0,0,0,1,1,0],[0,1,0,0,1,0,1,0,0,1],[0,1,0,1,1,1,1,1,0,1],[0,0,1,1,0,1,0,1,1,0],[0,0,0,1,1,1,1,1,0,0],[0,0,1,1,1,0,1,1,1,0],[0,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,0],[0,0,1,1,1,1,1,1,1,0]],ae=[[1,1,0,1,1,0,0,0,0,0,0,1,1,0,1],[1,1,0,1,1,0,1,0,0,1,0,1,1,0,1],[0,1,1,1,1,0,1,0,0,1,0,1,1,0,1],[0,0,1,1,1,1,1,0,0,0,1,1,1,1,1],[0,0,0,0,1,1,0,1,1,1,1,1,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,0,0],[0,0,0,0,0,1,0,1,0,1,1,1,1,1,0],[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,1,1,0,1,1,1,1,1],[0,1,0,1,1,1,0,0,0,0,1,1,1,1,1],[0,1,1,1,1,1,0,0,0,0,1,1,1,1,1],[0,0,1,1,1,0,0,0,0,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,1,1,1,1,1,1]],ie=[[0,0,0,0,0,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[1,1,0,1,1,0,1,0,0,0,1,1,0,1,1],[1,1,1,1,1,0,1,0,0,0,1,1,1,1,1],[1,0,0,0,1,0,1,0,0,0,1,0,0,0,1],[1,0,1,0,1,0,1,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,1,0,0,0,0,0,0,0,1,0,0,1],[1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],[1,0,0,1,0,0,1,1,1,0,0,1,0,0,1],[1,0,0,1,0,0,1,1,1,0,0,1,0,0,1],[1,0,0,0,0,0,1,1,1,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],le=[[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,0,0,0,0,0,0],[0,0,0,0,1,1,1,1,1,1,1,0,0,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,1,0,1,0,1,0,1,0,1,0,1,0,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],[0,1,1,0,1,1,1,1,1,1,1,0,1,1,0],[0,1,0,0,0,1,1,0,1,1,0,0,0,1,0],[0,1,1,0,1,1,0,0,0,1,1,0,1,1,0],[0,1,1,0,1,1,0,0,0,1,1,0,1,1,0],[0,1,1,1,1,1,0,0,0,1,1,1,1,1,0],[0,1,1,1,1,1,1,1,1,1,1,1,1,1,0]],de=[[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,1,1,1,1,0,1,1,1],[0,0,0,0,0,0,0,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0,1,1,1,0,0,0],[0,0,0,0,0,0,0,0,1,1,1,1,1,0,0],[1,0,0,0,0,0,1,1,1,1,1,1,1,1,0],[1,1,1,0,0,1,1,1,0,0,0,1,1,1,0],[1,1,1,1,1,1,1,0,1,1,1,0,1,1,0],[0,1,1,1,1,1,0,1,1,1,1,0,1,1,0],[0,1,1,1,1,1,1,1,1,0,0,1,1,0,0],[0,0,1,1,1,1,1,1,1,1,1,1,0,0,0],[0,0,0,0,1,1,0,1,1,1,0,0,0,0,0],[0,0,0,0,0,0,1,1,1,1,1,1,0,0,0]],me=[[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],[0,0,0,0,0,1,1,1,1,0,0,1,1,0,1],[0,0,0,1,1,1,0,0,1,0,0,1,0,1,0],[1,1,1,0,1,1,1,0,1,0,0,1,0,0,0],[1,1,1,1,1,1,1,1,0,0,0,1,1,0,0],[0,1,1,1,1,1,1,1,1,0,0,0,1,1,0],[0,0,0,0,1,1,1,1,1,1,0,0,0,1,1],[0,0,0,0,0,1,1,1,1,1,1,1,0,0,1],[0,0,0,0,0,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,1,0,0,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,1,0],[0,0,0,0,0,1,1,1,1,0,0,1,1,1,0],[0,0,0,0,1,1,1,0,0,0,1,1,1,0,0]],R={easy:[{name:"Dinosaur",matrix:Q},{name:"Fortress",matrix:X},{name:"Plane",matrix:Y},{name:"Goblet",matrix:ee},{name:"Skull",matrix:te}],medium:[{name:"House",matrix:se},{name:"Aerostat",matrix:oe},{name:"Cuppa",matrix:re},{name:"Smiley",matrix:ne},{name:"Mouse",matrix:ce}],hard:[{name:"Deer",matrix:ae},{name:"Rat",matrix:me},{name:"Castle",matrix:ie},{name:"Duck",matrix:de},{name:"Church",matrix:le}]};function ue(t,e){t.innerHTML="",R[e].map(n=>n.name).forEach(n=>{const s=document.createElement("option");s.value=n,s.textContent=n,s.className="nonogram-names-option",t.appendChild(s)})}const f=JSON.parse(localStorage.getItem("currentNonogram"))||null,a={nonogram:{name:"",playerName:"uknown player",difficulty:"",matrix:[],currentProgress:(f==null?void 0:f.currentProgress)||[],truthyCellsIndexes:(f==null?void 0:f.truthyCellsIndexes)||[],excludedCellsIndexes:(f==null?void 0:f.excludedCellsIndexes)||[],truthyCells:[],falsyCells:[]}},O=a.nonogram;function P(t){for(const e in t)t.hasOwnProperty(e)&&O.hasOwnProperty(e)&&(O[e]=t[e])}function M(t=0){return Array.from({length:t},()=>Array(t).fill(0))}function fe(t){const e=[];for(let o=0;o<t[0].length;o++){const r=[];for(let n=t.length-1;n>=0;n--)r.push(t[n][o]);e.push(r.reverse())}return e}function _(t){let e=[],o=1;if(!t.includes(1))return e.push(0),e.join(" ");for(let r=0;r<t.length;r+=1){let n=t[r],s=t[r+1];n===1&&s===1?o+=1:n===1&&!s&&(e.push(o),o=1)}return e.join(" ")}function ge(){const e=document.getElementById("helpDialog").content.cloneNode(!0);return e.querySelector(".ok").addEventListener("click",p),e}function he(){const t=a.nonogram.matrix,e=fe(t),o=document.createElement("thead"),r=document.createElement("tr");for(let n=0;n<=t.length;n++){const s=document.createElement("th");if(s.className=`th_top ${a.nonogram.difficulty}`,n===0){const c=document.createElement("button");c.textContent="?",c.title="HELP",c.addEventListener("click",()=>{const m=ge();x(m),S("confirm")}),s.appendChild(c)}if(n>0&&e[n-1]){const c=_(e[n-1]);s.innerHTML=c.replace(/\s/g,"<br>")}r.appendChild(s)}return o.appendChild(r),o}class ye{constructor(e){this.container=e,this.time=Number(localStorage.getItem("timer"))||0,this.intervalId=null,this.isRunning=!1,this.render()}start(){this.intervalId||(this.intervalId=setInterval(()=>{this.time+=1,this.update()},1e3),this.isRunning=!0)}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,this.isRunning=!1)}reset(){this.stop(),this.time=0,this.update()}render(){this.container instanceof Element&&(this.container.textContent=this.formatTime(this.time))}update(){this.container instanceof Element&&(this.container.textContent=this.formatTime(this.time),this.setLocalStorage())}getTime(){return this.time}setLocalStorage(){localStorage.setItem("timer",this.time)}formatTime(e){const o=Math.floor(e/60),r=e%60,n=String(o).padStart(2,"0"),s=String(r).padStart(2,"0");return`${n}:${s}`}}const pe=document.querySelector(".timer-section span"),N=new ye(pe);function xe(){const e=document.getElementById("victoryDialog").content.cloneNode(!0);return e.querySelector(".ok").addEventListener("click",p),e}function Ce(t){const e={easy:1,medium:2,hard:3};return t.sort((o,r)=>{const n=e[r.difficulty]-e[o.difficulty];return n===0?o.time-r.time:n})}function Se(t){const e=JSON.parse(localStorage.getItem("recordsTable"))||[];e.push(t);const o=Ce(e);for(;o.length>5;)o.pop();localStorage.setItem("recordsTable",JSON.stringify(o))}function J(){const t={name:"",playerName:"",difficulty:"",matrix:[],currentProgress:[],truthyCells:[],falsyCells:[],truthyCellsIndexes:[],excludedCellsIndexes:[]};P(t),localStorage.setItem("currentNonogram",JSON.stringify(t))}function G(){const{truthyCells:t,falsyCells:e}=a.nonogram;t.forEach(o=>{o.classList.remove("excluded","border5x5H","border5x5V"),o.classList.add("colorized")}),e.forEach(o=>{o.classList.remove("colorized","excluded","border5x5H","border5x5V")}),E.style.pointerEvents="none",J(),N.reset()}function Ee(){const t=JSON.parse(JSON.stringify(a.nonogram)),{name:e,playerName:o,difficulty:r}=t,n=N.getTime(),s={nonogramName:e,playerName:o,difficulty:r,time:n},c=xe();x(c),S("victory"),Se(s),G()}function be(t,e){if(t.target.nodeName!=="TD")return;const o=a.nonogram.currentProgress,r=a.nonogram.matrix,n=t.target;n.classList.toggle("colorized"),n.classList.remove("excluded");const s=e.indexOf(n),c=Math.floor(s/r.length),m=s-r.length*c,l=o[c];let i=l[m];i=i?0:1,l[m]=i;const d=a.nonogram.truthyCellsIndexes,h=a.nonogram.excludedCellsIndexes;if(i)d.push(s);else{const C=d.indexOf(s);C!==-1&&d.splice(C,1)}const u=h.indexOf(s);u!==-1&&h.splice(u,1);const y=JSON.parse(localStorage.getItem("currentNonogram"))||{};y.currentProgress=o,y.truthyCellsIndexes=d,y.excludedCellsIndexes=h,localStorage.setItem("currentNonogram",JSON.stringify(y)),JSON.stringify(o)===JSON.stringify(r)&&Ee()}function A(){const t=[],e=[],o=[],r=document.createElement("tbody"),n=a.nonogram.matrix;for(let c=0;c<n.length;c++){const m=document.createElement("tr");for(let l=0;l<=n.length;l++){let i;l===0?(i=document.createElement("th"),i.classList.add("th_left",a.nonogram.difficulty),i.textContent=_(n[c])):(i=document.createElement("td"),i.classList.add("td",a.nonogram.difficulty),l%5===0&&n.length>5&&l!==n[c].length&&i.classList.add("border5x5V"),(c+1)%5===0&&n.length>5&&c+1!==n.length&&i.classList.add("border5x5H"),n[c][l-1]===1&&o.push(i),n[c][l-1]===0&&e.push(i),t.push(i)),m.appendChild(i)}r.appendChild(m)}r.addEventListener("click",c=>be(c,t));function s(c){!N.isRunning&&c.target.nodeName==="TD"&&N.start()}return r.addEventListener("click",s,{once:!0}),r.addEventListener("contextmenu",c=>{c.preventDefault(),s(c)},{once:!0}),a.nonogram.truthyCells=o,a.nonogram.falsyCells=e,r}const E=document.getElementById("table");function Ne(){E.innerHTML="";const t=he(),e=A();E.append(t,e)}function Ie(){const e=document.getElementById("newGameDialog").content.cloneNode(!0),o=e.querySelector("form.start-game-form"),r=o.querySelector("#difficulty-select"),n=o.querySelector("#nonogram-names-select"),s=o.querySelector("#playerName");return r.addEventListener("change",()=>{const c=r.value;ue(n,c)}),o.addEventListener("submit",c=>{c.preventDefault();const m=n.value,l=r.value,i=R[l].find(({name:h})=>h===m).matrix,d={name:m,difficulty:l,playerName:s.value.trim()||"uknown player",matrix:i,currentProgress:M(i.length)};J(),P(d),console.log(a),localStorage.setItem("currentNonogram",JSON.stringify(d)),p(),E.style.pointerEvents="all",Ne()}),e}function Le(){const t=E.querySelector("tbody"),e=E.querySelector("thead");t.remove();const o=a.nonogram.matrix.length,r={currentProgress:M(o),excludedCellsIndexes:[],truthyCellsIndexes:[]};P(r);const n=JSON.parse(localStorage.getItem("currentNonogram"))||{};n.currentProgress=a.nonogram.currentProgress,n.excludedCellsIndexes=a.nonogram.excludedCellsIndexes,n.truthyCellsIndexes=a.nonogram.truthyCellsIndexes,localStorage.setItem("currentNonogram",JSON.stringify(n)),e.insertAdjacentElement("afterend",A())}function H(){const e=document.getElementById("resetGameDialog").content.cloneNode(!0);return e.querySelector(".ok").addEventListener("click",p),e}function ve(){var e,o;if(!!((e=a==null?void 0:a.nonogram)!=null&&e.name)&&!!((o=a==null?void 0:a.nonogram)!=null&&o.difficulty))Le();else{const r=H();x(r),S("alert")}}function ke(){const e=document.getElementById("showSolutionDialog").content.cloneNode(!0),o=e.querySelector(".submit"),r=e.querySelector(".cancel");return o.addEventListener("click",()=>{G(),p()}),r.addEventListener("click",p),e}function we(){var e,o;if(!!((e=a==null?void 0:a.nonogram)!=null&&e.name)&&!!((o=a==null?void 0:a.nonogram)!=null&&o.difficulty)){const r=ke();x(r)}else{const r=H();x(r)}S("alert")}function Pe(){const t=document.createElement("div");t.className="records-container";const e=document.createElement("h3");e.textContent="Records",e.className="difficulty-label form-title";const o=document.createElement("button");o.className="control-btn start-game-btn",o.textContent="OK",o.addEventListener("click",p);const r=document.createElement("table");r.className="records-table";const n=document.createElement("thead"),s=document.createElement("tr");["#","Player Name","Nonogram","Difficulty","Time"].forEach(i=>{const d=document.createElement("th");d.className="records__th",d.textContent=i,s.appendChild(d)}),n.appendChild(s),r.appendChild(n);const m=document.createElement("tbody"),l=JSON.parse(localStorage.getItem("recordsTable"))||[];for(let i=0;i<5;i+=1){const d=document.createElement("tr"),h=document.createElement("td");if(h.textContent=(i+1).toString(),d.appendChild(h),l[i]){const u=l[i];["playerName","nonogramName","difficulty","time"].forEach(b=>{const C=document.createElement("td");b==="time"&&!isNaN(u[b])?C.textContent=N.formatTime(u[b]):C.textContent=u[b],d.appendChild(C)})}else for(let u=0;u<4;u+=1){const y=document.createElement("td");y.textContent="empty",d.appendChild(y)}m.appendChild(d)}return r.appendChild(m),t.append(e,r,o),t}const L=document.querySelector(".control-btn.new-game"),v=document.querySelector(".control-btn.reset-game"),k=document.querySelector(".control-btn.show-solution"),w=document.querySelector(".control-btn.records");function Te(){L==null||L.addEventListener("click",()=>{const t=Ie();x(t),S("confirm")}),v==null||v.addEventListener("click",ve),k==null||k.addEventListener("click",we),w==null||w.addEventListener("click",()=>{const t=Pe();x(t),S("victory")})}document.addEventListener("DOMContentLoaded",function(){const t=K("displayMode")||"light";V(t)});j.addEventListener("click",B);Z.addEventListener("click",W);$();Te();I==null||I.addEventListener("click",p);
//# sourceMappingURL=main-CrGqjGBZ.js.map
